---
import Layout from '../../layouts/Layout.astro';
import ColorIcons from '../../components/ColorIcons.astro';
import commandersList from '../../data/commanders.json';

export function getStaticPaths() {
  return (commandersList as any[])
    .filter((c: any) => c.has_partners)
    .map((c: any) => ({ params: { id: c.id }, props: { commander: c } }));
}

const { commander } = Astro.props;
---
<Layout title={`Партнёры для ${commander.name}`}>
  <div class="flex items-center gap-4 mb-8">
    {commander.image_uri && <img src={commander.image_uri} alt={commander.name} class="w-20 rounded-lg shadow-lg" />}
    <div>
      <h1 class="text-2xl md:text-3xl font-bold text-amber-400">Партнёры для {commander.name}</h1>
      <a href={`/commanders/${commander.id}`} class="text-gray-400 hover:text-amber-400 text-sm">← Назад к коммандеру</a>
    </div>
  </div>

  <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
    {commander.partners.map((p: any) => {
      const pairId = [commander.id, p.id].sort().join('--');
      return (
        <a href={`/commanders/${pairId}`} class="bg-gray-900 rounded-xl overflow-hidden hover:ring-2 hover:ring-amber-500 transition block">
          {p.image_uri && <img src={p.image_uri} alt={p.name} class="w-full" loading="lazy" />}
          <div class="p-3">
            <div class="text-sm font-medium truncate">{p.name}</div>
            <div class="text-xs text-gray-400 mt-1">{p.deck_count} деков</div>
          </div>
        </a>
      );
    })}
  </div>
</Layout>
